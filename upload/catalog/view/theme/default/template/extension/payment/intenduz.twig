{% if intenduz_method == 'only_card' %}

    <div class="buttons pull-right">
        <button class="intend_button btn btn-primary"><i></i>{{ button_confirm }}</button>
    </div>

    <script src="https://my.intend.uz/pay/checkout.js"></script>
    <script>
        var btn = document.querySelector(".intend_button");
        btn.addEventListener("intend", function () {
            createPaymentRequest({
                service_id       : {{ merchantServiceID }},
                merchant_id      : {{ merchantID }},
                amount           : {{ transAmount }},
                transaction_param: {{ transID }},
                merchant_user_id : {{ merchantUserID }}
            }, function (data) {
                if (data && (data.status === 2 || data.status === 0)) {
                    $.ajax({
                        url       : 'index.php?route=extension/payment/intenduz/payment_received',
                        dataType  : 'json',
                        beforeSend: function () {
                            $('.intend_button').button('loading');
                        },
                        complete  : function () {
                            $('.intend_button').button('reset');
                        },
                        success   : function (json) {
                            if (json['redirect']) {
                                location = json['redirect'];
                            }
                        },
                        error     : function (xhr, ajaxOptions, thrownError) {
                            alert(thrownError + "\r\n" + xhr.statusText + "\r\n" + xhr.responseText);
                        }
                    });
                }
            });
        });
    </script>

{% else %}
    <div class="buttons pull-right">
        <a href="{{ redirectUrl }}" class="intend_button btn btn-primary">
            <i></i>{{ button_confirm }}
        </a>
    </div>
{% endif %}

<style><!--
    .intend_button {
        line-height: 25px;
    }

    .intend_button i {
        background: url(https://intend.uz/wp-content/themes/itrust/favicon/apple-icon-57x57.png) no-repeat top left;
        width: 30px;
        height: 25px;
        display: block;
        float: left;
    }
</style>

